<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gelato!</title>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Gelato" />
    <link rel="manifest" href="/site.webmanifest" />
    <style>
      :root{
        --bg: #f5ddbe;      /* page / image background */
        --bubble-bg: #ffffff;
        --bubble-text: #5a3740;
        --gap: 1px;        /* gap between image and bubble */
      }

      html,body{
        height:100%;
        margin:0;
        background:var(--bg);
        display:flex;
        align-items:center;
        justify-content:center;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Helvetica Neue";
      }

      .container{
        position:relative;
        display:inline-block;
        overflow:visible; /* ensure tail can be visible outside bubble */
      }

      #mascot{
        display:block;
        max-width:320px;
        width: min(44vw, 320px);
        height:auto;
        animation: float 3.6s ease-in-out infinite;
      }

      @keyframes float{
        0%   { transform: translateY(0); }
        50%  { transform: translateY(-8px); }
        100% { transform: translateY(0); }
      }

      /* comic bubble */
      .bubble{
        position:absolute;
        left: calc(100% + var(--gap));
        top: 50%;
        transform: translateY(-50%);
        max-width: 260px;
        width: 260px;
        background: var(--bubble-bg);
        color: var(--bubble-text);
        padding: 12px 14px;
        border-radius: 16px;
        box-shadow: 0 8px 22px rgba(90,55,64,0.08);
        font-size: 0.95rem;
        line-height: 1.25;
        transition: opacity .28s ease, transform .18s ease, left .2s ease, top .2s ease;
        opacity: 1;
        pointer-events: none;
        overflow: visible; /* so SVG tail remains visible */
        border: 1px solid rgba(0,0,0,0.03);
      }
      .bubble::before {
        content: '';
        position: absolute;
        top: 50%; /* moved down to match bubble vertical shift */
        left: -29px;
        width: 30px;
        height: 20px;
        background: #fff;
        clip-path: polygon(100% 0, 0 50%, 100% 100%);
      }

      .bubble.hidden{ opacity: 0; }

      /* When bubble is above the mascot, place the tail centered at bubble's bottom and flip it */
      .bubble.bubble--above {
        left: 50%;
        transform: translate(-50%, -120%); /* move above mascot */
        top: auto;
      }
      .bubble.bubble--above::before {
        left: calc(50% - 15px); /* center tail */
        top: -20px; /* use custom property for tail Y position */
        transform: rotate(90deg); /* flip the tail */
      }
      .bubble.bubble--above {
        left: calc(50% - 14px);
        top: 100%;
        transform: translateY(0) rotate(180deg);
      }
      .bubble.bubble--above span {
        transform: translateY(0) rotate(180deg);
      }

      /* keep layout stable */
      #joke { min-height: 2.5em; display:block; }
      @media (max-width:420px){
        #mascot { width: 200px; }
        .bubble { max-width: 210px; font-size: .88rem; }
      }
    </style>
  </head>
  <body>
    <div class="container" id="container">
      <img id="mascot" src="mascot.320x320.webp" alt="Gelatti" />

      <!-- Speech bubble (default text acts as no-JS fallback) -->
      <div class="bubble" id="bubble" role="status" aria-live="polite">
        <span id="joke">
          Hey. You weren't on the guest list.
          But fine ‚Äî take a scoop. Don't tell anyone I bribed you with gelato üç®
        </span>

      </div>
    </div>

    <script>
      /* ---- jokes list ---- */
      const jokes = [
        "Hey. You weren't on the guest list. But fine ‚Äî take a scoop. Don't tell anyone I bribed you with gelato üç®",
        "You look lost, sweetie. Want me to stab you... with a waffle cone? üç¶",
        "Hey stranger, want a brain freeze and emotional damage in one scoop? üç®",
        "Come closer‚Ä¶ I promise the sprinkles aren‚Äôt poisoned. Probably. üå∏",
        "I churned this gelato with pure malice and 20% love. ‚ù§Ô∏è",
        "You scream, I scream, everyone screams‚Ä¶ for different reasons. üçß",
        "Careful, my gelato bites back. Hard. üêæ",
        "Don‚Äôt run away, dessert tastes better when you‚Äôre terrified. üòà",
        "You‚Äôre not on the guest list, but I‚Äôll bribe you with sorbet. üçã",
        "Every scoop I serve steals a tiny piece of your soul. üíÄ",
        "This gelato is 90% sugar, 10% chaos. üåÄ",
        "Want some sprinkles with your impending doom? üåà",
        "Gelato so good you‚Äôll forget your safe word. üòâ",
        "The cone is crunchy, your fate is crunchier. ü™ì",
        "You can‚Äôt escape‚Ä¶ I already pre-scooped your destiny. ‚ùÑÔ∏è",
        "If you drop it, I drop you. üî™",
        "Gelato therapy: first bite free, consequences extra. üí∏",
        "You‚Äôre cute‚Ä¶ almost cute enough for free toppings. Almost. üòè",
        "Let me sweeten your day‚Ä¶ aggressively. üí•",
        "The ice cream truck plays my battle theme. üéµ",
        "This gelato pairs well with regret. üç´",
        "Do you prefer vanilla, chocolate, or mild intimidation? üç¶",
        "It‚Äôs okay, I only hex people who order sorbet. üßô‚Äç‚ôÄÔ∏è",
        "Eat now, run later‚Ä¶ if you can. üèÉ‚Äç‚ôÇÔ∏è",
        "Every lick brings you closer to danger. üêâ",
        "Cone or cup? Wrong answer. ‚ò†Ô∏è",
        "You thought you came for dessert, but dessert came for you. üîÆ",
        "Don‚Äôt mind the screams from the freezer. They‚Äôre just‚Ä¶ cherries. üçí",
        "If you finish the triple scoop, you unlock my final form. ü¶ã",
        "The sprinkles know your secrets. ü§´",
        "Say 'ahh'‚Ä¶ forever. üåå",
        "Life is short, eat gelato ‚Äî before it eats you. üêæ",
        "Pick a flavor. Pick a fate. I'll be here, smirking. üòèüç®",
        "Blink twice for sprinkles. Blink once for judgment. üëÄ‚ú®",
        "Choose wisely. I grade on a waffle curve. üç¶üìö",
        "Today's special: pistachio with a hint of menace. üíöüòº",
        "You get one free sample and unlimited side-eye. ü•ÑüôÉ",
        "I'm small, I'm sweet, I'm mildly terrifying. Order up. üéÄüçß",
        "Ask nicely. I'm bilingual in sweet and sass. üí¨üç®",
        "Whipped cream? Only if you've been emotionally responsible. üçíüìù",
        "I don't do discounts. I do standards. High ones. üíÖüç¶",
        "Flavor notes: vanilla, velvet, victory. üèÜüç®",
        "If you flinch, I'm adding basil. üåøüòâ",
        "Touch my gelato and we have a situation. ü´≥üç®",
        "Eat faster. The drama is melting. üé≠ü´†",
        "I stirred this with a spoon and pure accountability. ü•Ñ‚ú®",
        "Cone or cup? Wrong. It's an audition. üé§üç¶",
        "Make a wish. If it's gelato, approved. üåüüçß",
        "Chocolate so dark it remembers your texts. üç´ü´¢",
        "Sorbet is for the drama-averse. I see you. üçãüòå",
        "Yes, it's artisanal. No, that doesn't make you special. I do. üëëüç®",
        "Smile with your eyes. The cone is watching. üëÄüç¶",
        "My sprinkles keep receipts. ü§´üåà",
        "Your spoon is plastic. My will is titanium. üßäüí™",
        "Be brave. It's lemon. It bites a little. üçãüòà",
        "Three licks in and you're negotiating with destiny. üîÆüç®",
        "Napkins? That's adorable. üßªüôÇ",
        "Ask for a sample, get a vibe check. ü•Ñüß≠",
        "I'm limited edition and unlimited opinions. üí¨‚ú®",
        "Sundae? It's Tuesday. I break rules, not hearts. Usually. üìÖüòâ",
        "I garnish with mint and judgment. üåøüòå",
        "No loyalty card here. Earn it with charisma. üéüÔ∏èüòè",
        "I can fix your mood faster than your life choices. ‚ö°üçß",
        "We do refills. Of attitude. üîÅüíÅ‚Äç‚ôÄÔ∏è",
        "You drop it, you do the tiny walk of shame. üö∂‚Äç‚ôÇÔ∏èüç¶",
        "Yes, it's cold. I'm colder. ü•∂üíã",
        "Don't overthink it. That's my job. üß†üç®",
        "Gelato first, epiphany later. üí°üç¶",
        "I portion control by vibes. üîÆü•Ñ",
        "Choose chaos? That's the stracciatella. üç´üåÄ",
        "You're cute. Not 'extra scoop' cute, but cute. üòèüçß",
        "I take compliments in the form of toppings. üçíüíå",
        "Flavor of the day: consequences. üìãüç®",
        "Waffle cones are my love language and my boundary. üç¶‚ù§Ô∏è",
        "I flavored this with espresso and unspoken expectations. ‚òïüòº",
        "Order a double and I'll double my standards. ‚úåÔ∏èüìà",
        "Calorie math? I majored in denial. üéìüôÉ",
        "Be sweet or be gone. I have a line. üßÅ‚û°Ô∏è",
        "Finish it before it finishes judging you. ‚è≥üç¶",
        "House rule: pace yourself, not me. üè†üòå",
        "I sprinkle hope and mild intimidation. üåàüòà",
        "You're a delight. My gelato is the main character. üé¨üç®",
        "Careful‚Äîthis pistachio has opinions. üíöüó£Ô∏è",
        "I schedule kindness between scoops. You're welcome. üóìÔ∏èüçß",
        "Try me. No, the gelato. Try the gelato. üòÖüç®",
        "The freezer keeps secrets. I don't. üßäü§ê",
        "Your destiny is two scoops and a reality check. ü•ÑüîÆ",
        "My apron says 'please' on one side and 'try again' on the other. üëóüòâ",
        "Taste test? That's a commitment ceremony. üíçüç¶",
        "I run on sugar, spite, and impeccable timing. ‚è∞üç≠",
        "Pick a topping. Wrong answers get confetti anyway. üéâüåà",
        "I do customer service with a flourish and a warning. üéÄ‚ö†Ô∏è",
        "Sweetness guaranteed. Compliance encouraged. ‚úÖüçß",
        "This tiramisu believes in you. I remain skeptical. ‚òïüòå",
        "I serve moments, not just scoops. Some are louder. üì£üç®",
        "No such thing as too much gelato, just too little courage. üí´üç¶",
        "Your aura says vanilla. Prove me wrong. ‚ú®üç®",
        "I don't chase. I chill. Then I judge. üßäüßê",
        "Careful with the caramel. It remembers everything. üçØüëÄ",
        "Spoonful of sweetness, dash of menace. Balanced. ‚öñÔ∏èüçß",
        "Welcome to my gelato arc. Character development not optional. üìöüç¶",
        "I came with sprinkles and an agenda. üåàüìù",
        "Say 'ahh'... for a reasonable amount of time. üå¨Ô∏èüç®",
        "If you hesitate, I curate. üñºÔ∏èü•Ñ",
        "I'm the plot twist your sweet tooth ordered. üîÄüçß"
      ];

      const bubble = document.getElementById('bubble');
      const jokeEl = document.getElementById('joke');
      const mascot = document.getElementById('mascot');
      const container = document.getElementById('container');

      let lastIndex = -1;

      /* pick a random joke, fade out/in, reposition bubble after text change */
      function setRandomJoke() {
        let idx;
        do {
          idx = Math.floor(Math.random() * jokes.length);
        } while (idx === lastIndex && jokes.length > 1);
        lastIndex = idx;

        bubble.classList.add('hidden');
        setTimeout(() => {
          jokeEl.textContent = jokes[idx];
          positionBubble(); // reposition after content change (bubble size may change)
          bubble.classList.remove('hidden');
        }, 280);
      }

      /* Position the bubble and tail to point to mascot's mouth.
   If there is not enough room to the right, place bubble above the mascot
   and flip the tail downward.
       */
      function positionBubble() {
        const mRect = mascot.getBoundingClientRect();
        const cRect = container.getBoundingClientRect();

        // relative mouth Y inside the image (tweak this if tail needs vertical adjustment)
        const mouthRel = 0.62; // 0..1 (0 = top, 1 = bottom)
        const mouthY = mRect.top - cRect.top + mouthRel * mRect.height;

        // default bubble to the right of image
        const gap = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--gap')) || 20;
        let left = (mRect.right - cRect.left) + gap;
        let top = mouthY - bubble.offsetHeight * 0.5;

        // clamp top so bubble doesn't go outside container (a little margin)
        const minTop = 6;
        const maxTop = window.innerHeight - cRect.top - 6 - bubble.offsetHeight;
        if (top < minTop) top = minTop;
        if (top > maxTop) top = maxTop;

        // Check if bubble overflows viewport on the right; if so, place it above the mascot
        const willOverflowRight = (left + bubble.offsetWidth + 260) > (window.innerWidth - 8);
        if (willOverflowRight) {
          // place above, centered horizontally relative to mascot
          bubble.classList.add('bubble--above');
          const centeredLeft = (mRect.left - cRect.left) + (mRect.width / 2) - (bubble.offsetWidth / 2);
          bubble.style.left = `${Math.max(8, centeredLeft)}px`;
          // place above mascot with small gap
          bubble.style.top = `${(mRect.top - cRect.top) - bubble.offsetHeight - 12}px`;
          // tail: position near bottom center of bubble
          const tailY = bubble.offsetHeight - 6; // a little above bottom edge
          bubble.style.setProperty('--tail-top', `${tailY}px`);
        } else {
          bubble.classList.remove('bubble--above');
          bubble.style.left = `${left}px`;
          bubble.style.top = `${top}px`;
          // compute tail Y within bubble (so it points to mouth position)
          const tailY = (mouthY - top);
          // clamp inside bubble
          const clampedTailY = Math.max(8, Math.min(bubble.offsetHeight - 8, tailY));
          bubble.style.setProperty('--tail-top', `${clampedTailY}px`);
        }
      }

      /* attach events */
      window.addEventListener('resize', positionBubble);
      window.addEventListener('scroll', positionBubble);
      window.addEventListener('orientationchange', positionBubble);

      /* On image load or if cached already, position and start jokes */
      function start() {
        positionBubble();
        setRandomJoke();
        setInterval(setRandomJoke, 4000);
      }

      if (mascot.complete) {
        // image already loaded from cache
        start();
      } else {
        mascot.addEventListener('load', start);
      }
    </script>
  </body>
</html>
